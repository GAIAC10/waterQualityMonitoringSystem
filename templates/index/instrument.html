<!DOCTYPE html>
<html lang="en">

<head>
    {% load static %}
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Responsive Admin Dashboard Template">
    <meta name="keywords" content="admin,dashboard">
    <meta name="author" content="stacks">
    <title>设备管理</title>
    <link href="https://fonts.googleapis.com/css?family=Poppins:400,500,700,800&display=swap" rel="stylesheet">
    <link href="{% static 'plugins/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'plugins/font-awesome/css/all.min.css' %}" rel="stylesheet">
    <link href="{% static 'plugins/perfectscroll/perfect-scrollbar.css' %}" rel="stylesheet">
    <link href="{% static 'plugins/apexcharts/apexcharts.css' %}" rel="stylesheet">
    <link href="{% static 'css/main.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/custom.css' %}" rel="stylesheet">
    <style>
        span1 {
            font-family: 'icomoon';
            font-size: 15px;
        }
        .ph_style {
            color: red;
        }
        .ftu_style {
            color: red;
        }
        .tds_style {
            color: red;
        }
        .tem_style{
            color:red;
                 }
    </style>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
</head>

<body>

    <div class='loader'>
        <div class='spinner-grow text-primary' role='status'>
            <span class='sr-only'>Loading...</span>
        </div>
    </div>
    <div class="page-container">
        <div class="page-header">
            <nav class="navbar navbar-expand-lg d-flex justify-content-between">
                <div class="" id="navbarNav">
                    <ul class="navbar-nav" id="leftNav">
                        <li class="nav-item"><a class="nav-link" id="sidebar-toggle" href="#"><i data-feather="arrow-left"></i></a></li>
                    </ul>
                </div>
                <div class="logo">
                    <a class="navbar-brand" href="/index/instrument"></a>
                </div>
                <div class="" id="headerNav">
                    <ul class="navbar-nav">
                        <li class="nav-item dropdown">
                            <a class="nav-link profile-dropdown" href="#" id="profileDropDown" role="button" data-bs-toggle="dropdown" aria-expanded="false"><img src="{% static 'images/avatars/profile-image.png' %}" alt=""></a>
                            <div class="dropdown-menu dropdown-menu-end profile-drop-menu" aria-labelledby="profileDropDown">
                                    <a class="dropdown-item" href="{% url 'users:loginout' %}"><i data-feather="log-out"></i>退出登录</a>
                                    <a class="dropdown-item" href="/admin"><i data-feather="log-out"></i>管理员登陆</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
            <div class="page-sidebar">
                <ul class="list-unstyled accordion-menu">
                    <li class="sidebar-title">全部设备</li>
                    <li><a href="#"><i data-feather="layers"></i>设备1</a></li>
                    <li><a href="#"><i data-feather="layers"></i>设备2</a></li>
                    <li><a href="#"><i data-feather="layers"></i>设备3</a></li>
                </ul>
            </div>
            <div class="page-content">
                <div class="main-wrapper">
                    <div class="row">
                        <div class="col-md-6 col-xl-3">
                            <div class="card stat-widget">
                                <div class="card-body ph">
                                    <h5 class="card-title">酸碱度 PH</h5>
                                    <!-- PH显示 -->
                                    <h2 class="PH ph_style" id="ph">{{ PH }}</h2>
                                    <div class="progress">
                                        <div class="progress-bar bg-info progress-bar-striped" role="progressbar" style="width: 100%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-xl-3">
                            <!--浊度显示  -->
                            <div class="card stat-widget">
                                <div class="card-body">
                                    <h5 class="card-title">浊度 TU</h5>
                                    <h2 class="FTU ftu_style" id="tu">{{ TU }}</h2>
                                    <div class="progress">
                                        <div class="progress-bar bg-success progress-bar-striped" role="progressbar" style="width: 100%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-xl-3">
                            <!-- TDS显示 -->
                            <div class="card stat-widget">
                                <div class="card-body">
                                    <h5 class="card-title">固体溶解度 TDS</h5>
                                    <h2 class="TDS tds_style" id="tds">{{ TDS }}</h2>
                                    <div class="progress">
                                        <div class="progress-bar bg-danger progress-bar-striped" role="progressbar" style="width:100%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-xl-3">
                            <div class="card stat-widget">
                                <div class="card-body">
                                    <h5 class="card-title">温度 TEM</h5>
                                    <h2 class="TEM tem_style" id="tem">{{ TEM }}</h2>
                                    <div class="progress">
                                        <div class="progress-bar bg-primary progress-bar-striped" role="progressbar" style="width: 100%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="cod-md-2 col-xl-12">
                            <div class="card stat-widget">
                                <div class="card-body">
                                    <div class="card-title" id="button" align="center" onclick="window.location.href='/index/main';">点击了解更多</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    <!-- Javascripts -->
    <script src="{% static 'plugins/jquery/jquery-3.4.1.min.js' %}"></script>
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="{% static 'plugins/bootstrap/js/bootstrap.min.js' %}"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="{% static 'plugins/perfectscroll/perfect-scrollbar.min.js' %}"></script>
    <script src="{% static 'plugins/apexcharts/apexcharts.min.js' %}"></script>
    <script src="{% static 'js/main.min.js' %}"></script>
    <script src="{% static 'js/pages/dashboard.js' %}"></script>

    <script>
        var ph1 = $('.PH')
        var ph = $('.PH').text()
        if (ph > 8 || ph < 6) {
            ph1.addClass("ph_style")
        } else {
            ph1.removeClass("ph_style")
        }
    </script>
    <script>
        var ftu1 = $('.FTU')
        var ftu = $('.FTU').text()
        if (ftu > 500 || ftu < 100) {
            ftu1.addClass("ftu_style")
        } else {
            ftu1.removeClass("ftu_style")
        }
    </script>
    <script>
        var tds1 = $('.TDS')
        var tds = $('.TDS').text()
        if (tds > 1000) {
            tds1.addClass("tds_style")
        } else {
            tds1.removeClass("tds_style")
        }
    </script>
    <script>
        var tds1 = $('.TEM')
        var tds = $('.TEM').text()
        if (tds < 25|| tds>35 ) {
            tds1.addClass("tem_style")
        } else {
            tds1.removeClass("tem_style")
        }
    </script>

        <script>
        var obj1 = document.getElementById('ph');
        var obj2 = document.getElementById('tu');
        var obj3 = document.getElementById('tds');
        var obj4 = document.getElementById('tem');

        setInterval(function() {
        $.ajax({
            type:"GET",
            url:"http://127.0.0.1:8000/index/instrument_data",
            async:false,
            success:function (result) {
                if (result['code']===200){
                    var ph=result['data']['ph'];
                    var tu=result['data']['tu'];
                    var tds=result['data']['tds'];
                    var tem=result['data']['tem'];
                    obj1.innerText = ph;
                    obj2.innerText = tu;
                    obj3.innerText = tds;
                    obj4.innerText = tem;

                    console.log(obj1.innerText);
                    console.log(obj2.innerText);
                    console.log(obj3.innerText);
                    console.log(obj4.innerText);
                }
           }
        });},3000);
        </script>

</body>
</html>